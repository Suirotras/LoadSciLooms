% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Load_transcriptome_loom.R
\name{LoomAsSeurat}
\alias{LoomAsSeurat}
\title{Convert a loom file to a Seurat object}
\usage{
LoomAsSeurat(
  loom_path,
  matrix_rowname_col = "Gene",
  matrix_colname_col = "CellID",
  gmm_cell_calling = FALSE,
  gmm_k = 1:6,
  gmm_verbose = TRUE,
  resolve_duplicates = FALSE,
  Add_Odd_bc_md = FALSE,
  Odd_barcode_md_file = NULL,
  full_barcode_col = "BC",
  condition_col = "condition",
  Odd_barcode_col = "Odd_barcode",
  Odd_barcode_position = 2,
  seurat_assay_name = "RNA",
  seurat_min_cells = 0,
  seurat_names_field = 1L,
  seurat_names_delim = "_",
  ...
)
}
\arguments{
\item{loom_path}{A single-element character vector specifying the path to
the transcriptome loom file.}

\item{matrix_rowname_col}{A single-element character vector indicating the
column in the row (gene) metadata of the loom file that should be used as
feature names for the count matrix.}

\item{matrix_colname_col}{A single-element character vector indicating the
column in the column (cell) metadata of the loom file that should be used
as cell names for the count matrix.}

\item{gmm_cell_calling}{Logical value indicating whether GMM-based cell
calling should be performed. Default is \code{FALSE}.}

\item{gmm_k}{Integer vector specifying the number(s) of mixture components
to test. The model with the lowest BIC is selected. Default is \code{1:6}.}

\item{gmm_verbose}{Logical value indicating whether information about the
selected GMM (BIC and number of components) should be printed.}

\item{resolve_duplicates}{Logical value indicating whether duplicate
feature names should be resolved automatically. If \code{TRUE}, only the
first occurrence of each duplicated feature is retained. If \code{FALSE},
the function errors when duplicates are detected. Default is \code{FALSE}.}

\item{Add_Odd_bc_md}{Logical value indicating whether Odd-barcode metadata
annotation should be performed. Default is \code{FALSE}.}

\item{Odd_barcode_md_file}{A comma-separated file linking Odd barcode IDs to
metadata (e.g. treatment or condition). Must contain at least two columns:
one with Odd barcode identifiers and one with the corresponding condition.}

\item{full_barcode_col}{Character string specifying the column in the Seurat
metadata that contains the full cell barcode.}

\item{condition_col}{Character string specifying the name of the metadata
column in which to store condition labels.}

\item{Odd_barcode_col}{Character string specifying the name of the metadata
column in which to store extracted Odd barcodes.}

\item{Odd_barcode_position}{Integer specifying the position of the Odd
barcode after splitting the full barcode on underscores (\code{"_"}).}

\item{seurat_assay_name}{A single-element character vector specifying the
name of the assay in the created Seurat object.}

\item{seurat_min_cells}{Include only features detected in at least this many
cells.}

\item{seurat_names_field}{Integer specifying which substring of the cell
name (after splitting by \code{seurat_names_delim}) is used as the sample
name.}

\item{seurat_names_delim}{A single-element character vector specifying the
delimiter used to split cell names when extracting sample names.}

\item{...}{Additional arguments passed to
\code{SeuratObject::CreateSeuratObject()}.}
}
\value{
An object of class \code{lseurat}. This is a named list containing:
\describe{
\item{seurat}{A Seurat object containing the count matrix and metadata
derived from the loom file.}
\item{params}{A named list of parameters supplied to
\code{LoomAsSeurat()}.}
\item{gmm}{The \code{Mclust} object used for cell calling, or \code{NA} if
GMM-based cell calling was not performed.}
}
}
\description{
This function loads a transcriptome loom file and converts it into a
Seurat object wrapped inside an \code{lseurat} container. It supports
optional Gaussian mixture model (GMM)–based cell calling, automatic
resolution of duplicate feature names, and annotation of cells using
Odd-barcode–linked metadata.
}
\section{Loom file input}{

Arguments: \code{loom_path}, \code{matrix_rowname_col},
\code{matrix_colname_col}.

Control how the loom file is read and how features and cells are identified.
}

\section{Seurat object construction}{

Arguments: \code{seurat_assay_name}, \code{seurat_min_cells},
\code{seurat_names_field}, \code{seurat_names_delim}, \code{...}.

Control creation, filtering, and naming of the Seurat object.
}

\section{Duplicate feature handling}{

Arguments: \code{resolve_duplicates}.

Control how duplicate feature names are detected and resolved.
}

\section{GMM-based cell calling}{

Arguments: \code{gmm_cell_calling}, \code{gmm_k}, \code{gmm_verbose}.

Control Gaussian mixture model–based classification of cells.
}

\section{Odd-barcode metadata annotation}{

Arguments: \code{Add_Odd_bc_md}, \code{Odd_barcode_md_file},
\code{full_barcode_col}, \code{condition_col},
\code{Odd_barcode_col}, \code{Odd_barcode_position}.

Control annotation of cells using Odd-barcode–linked metadata.
}

\examples{
# Example 1: basic loom loading
lpath <- system.file("extdata", "i1_ES_subsample.loom",
  package = "LoadSciLooms")
lseurat <- LoomAsSeurat(
  lpath,
  matrix_rowname_col = "Gene",
  matrix_colname_col = "CellID",
  resolve_duplicates = FALSE,
  seurat_assay_name = "RNA",
  seurat_min_cells = 0,
  seurat_names_field = 1L,
  seurat_names_delim = "_"
)

# Example 2: loom loading with Odd-barcode metadata annotation
loom_file <- system.file("extdata", "i31_GSK126_subsample.loom",
  package = "LoadSciLooms")
odd_md_file <- system.file("extdata", "Odd_barcode_md.csv",
  package = "LoadSciLooms")
lseurat_odd <- LoomAsSeurat(
  loom_path = loom_file,
  matrix_rowname_col = "Gene",
  matrix_colname_col = "CellID",
  resolve_duplicates = FALSE,
  Add_Odd_bc_md = TRUE,
  Odd_barcode_md_file = odd_md_file,
  full_barcode_col = "BC"
)

# Resulting Seurat metadata will contain Odd-barcode metadata
head(lseurat_odd$seurat[[c("Odd_barcode", "condition")]])
}
